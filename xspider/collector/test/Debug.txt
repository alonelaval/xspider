# Spider Single Debug

from execute.baidu_spider import *
generator = Generator()
task = generator.start_generator()
print task

downloader = Downloader()
resp = downloader.start_downloader(task[0].get("url"),task[0].get("args",{}))

parser = Parser()
result = parser.start_parser(resp)

for k,v in result.items():
    print k,v


# Utils Debug

from collector.utils import *
from collector.models import Project

project = Project.objects(name="chinacourt").first()
print project.name
project_id = str(project.id)

generator = Generator(project_id)
task = generator.run_generator()

processor = Processor(task=task)
result = processor.run_processor()

for k,v in result.items():
    print k,v


## Worker Queue Debug

# start worker
 celery worker --app=xspider -l info -n worker1@%h -Q low-generator
 celery worker --app=xspider -l info -n worker2@%h -Q low-processor


# start flower
celery -A xspider flower


# scheduler debug

from scheduler.scheduler import XspiderScheduler

xs = XspiderScheduler()
xs.run_generator_dispatch()
xs.run_processor_dispatch()


